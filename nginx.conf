events { }
http {
    server {
        listen 	80;

        location /api {
            if ($request_uri ~ ^/api$) {
                return 301 $scheme://$host/api/;
            }
            proxy_redirect          off;
            proxy_set_header        Host $host;

            proxy_pass              http://api:8080;
            rewrite ^/api(.*)$ $1 break;

            proxy_http_version      1.1;
            proxy_set_header        Upgrade $http_upgrade;
            proxy_set_header        Connection "upgrade";
        }

        location / {
            proxy_redirect          off;
            proxy_set_header        Host $host;

            proxy_pass              http://patient:80;
        }

        location /employee {
            if ($request_uri ~ ^/employee$) {
                return 301 $scheme://$host/employee/;
            }

            proxy_redirect          off;
            proxy_set_header        Host $host;

            proxy_pass              http://employee:80;
            rewrite ^/employee(.*)$ $1 break;
        }
    }
}

